// Выполнил: Зеленков Илья ИТ-41

#include <iostream>
#include <iterator>
#include <vector>
#include <limits>
#include <time.h>

using namespace std;

#define INF 1000000000


int main(){

	// Тестовые матрицы
	int a0[5][5] = {
		{0, 0, 0, 0, 0},
    	{0, 1, 7, 1, 3},
    	{0, 1, 6, 4, 6},
    	{0, 17, 1, 5, 1},
    	{0, 1, 6, 10, 4},
    };
    
    int a1[6][6] = {
		{0, 0, 0, 0, 0, 0},
    	{0, 32, 28, 4, 26, 4},
    	{0, 17, 19, 4, 17, 4},
    	{0, 4, 4, 5, 4, 4},
    	{0, 17, 14, 4, 14, 4},
    	{0, 21, 16, 4, 13, 4},
    };

	int a[5][5] = {
		{0, 0, 0, 0, 0},
    	{0, 6, 2, 4, 3},
    	{0, 5, 7, 3, 3},
    	{0, 4, 1, 4, 2},
    	{0, 6, 7, 2, 1},
    };

	int a3[9][9] = {
		{0, 0, 0, 0, 0, 0, 0, 0},
    	{0, 32, 28, 4, 26, 4, 6, 3, 4},
    	{0, 17, 19, 4, 17, 4, 1, 5, 7},
    	{0, 4, 4, 5, 4, 4, 21, 6, 21},
    	{0, 17, 14, 4, 14, 4, 11, 12, 13},
		{0, 3, 16, 4, 13, 4, 4, 15, 10},
		{0, 21, 9, 7, 8, 4, 5, 9, 9},
		{0, 3, 16, 4, 9, 4, 5, 6, 10},
		{0, 9, 16, 4, 13, 4, 14, 9, 10},
    };

	int a4[13][13] = {
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		{0, 34523, 7858, 8743, 17325, 18510, 9231, 4920, 7056, 9701, 5034, 7825, 1233}, 
        {0, 8128, 435, 5021, 13603, 19635, 11386, 7075, 8840, 1843, 7189, 9256, 4234}, 
        {0, 6809, 5364, 3453, 8582, 14614, 10067, 5756, 5904, 7207, 3882, 4235, 12432}, 
        {0, 7849, 5515, 1040, 354, 15654, 11107, 6796, 4713, 7358, 4900, 5275, 4532}, 
        {0, 10918, 8365, 4109, 5808, 3456, 14176, 9865, 7928, 931, 7991, 8344, 23454}, 
        {0, 336, 7285, 2830, 11412, 17444, 678, 4347, 6483, 6688, 4461, 7065, 2345}, 
        {0, 1053, 2938, 3823, 12405, 15835, 4311, 879, 2136, 4781, 114, 2905, 1111}, 
        {0, 8930, 802, 5823, 14405, 20437, 12188, 7877, 345, 2645, 7429, 10058, 4323}, 
        {0, 9987, 7434, 3178, 11760, 17792, 13245, 8934, 6997, 867, 7060, 7413, 999}, 
        {0, 10518, 2824, 3709, 12291, 15721, 13776, 9465, 2022, 4667, 3242, 7944, 888}, 
        {0, 2574, 4459, 5344, 9561, 17356, 5832, 1521, 3657, 6302, 1635, 3265, 7890},
		{0, 9584, 900, 4441, 1000, 17765, 546, 2221, 3357, 5302, 1631, 3235, 7690}
   };

	int n = 4;
	int m = n;
	
	long t1 = clock();
	// Выполним алгоритм 20000 раз для более чёткого измерения времени
	for(int k=0; k < 20000; k++) {
		// Подготовительные матрицы
		vector<int> u (n+1), v (m+1), p (m+1), way (m+1);
		// Циклы короткого алгоритма
		for (int i=1; i<=n; ++i) {
			p[0] = i;
			int j0 = 0;
			vector<int> minv (m+1, INF);
			vector<char> used (m+1, false);
			do {
				used[j0] = true;
				int i0 = p[j0],  delta = INF,  j1;
				for (int j=1; j<=m; ++j)
					if (!used[j]) {
						int cur = a[i0][j]-u[i0]-v[j];
						if (cur < minv[j])
							minv[j] = cur,  way[j] = j0;
						if (minv[j] < delta)
							delta = minv[j],  j1 = j;
					}
				for (int j=0; j<=m; ++j)
					if (used[j])
						u[p[j]] += delta,  v[j] -= delta;
					else
						minv[j] -= delta;
				j0 = j1;
			} while (p[j0] != 0);
			do {
				int j1 = way[j0];
				p[j0] = p[j1];
				j0 = j1;
			} while (j0);
		}

		if (k == 19999) {
				vector<int> ans (n+1);
				for (int i=1; i<=m; ++i)
				{
					ans[p[i]] = i;
				}

					for (int i=1; i<=m; ++i)
				{
					cout << "x" << i << "->" << "y" << ans[i] << endl;
				}

				int cost = -v[0];
				cout << "Cost     : " << cost << endl;	
		}	
	}

	t1 = clock() - t1;
	cout << "Time for 20000 iterations (ms) : " <<  t1 << endl;

	int t;
	cin >> t;

	return 0;
}